<!DOCTYPE html>
<html lang="en">

<head>
    <title>Cory Gardner: 2020 Senate Race | The Denver Post</title>
    <meta charset="utf-8">
    <meta name="robots" content="noindex,follow">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed:700|Roboto+Mono" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/dataTables.foundation.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/foundation/6.2.4/foundation.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.foundation.min.css" />
    <!-- <link rel="stylesheet" href="jquery.dataTables.yadcf.css" /> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.14/c3.css" />
    <link rel="stylesheet" href="../css/styles.css" />
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/dataTables.foundation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/foundation/6.2.4/foundation.min.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/1.10.16/dataRender/datetime.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.1/js/responsive.foundation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/yadcf/0.9.2/jquery.dataTables.yadcf.js"></script>
    <script src="https://extras.denverpost.com/app/homicide-report/js/d3.v3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.14/c3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
    <script src="../js/moment.js"></script>
</head>

<body>
    <div class="row">
        <div id="gardner-section" class="large-10 large-centered medium-10 medium-centered columns">
            <nav aria-label="You are here:" role="navigation">
                <ul class="breadcrumbs">
                    <li><a href="../index.html">Home</a></li>
                    <li>
                        <span class="show-for-sr">Current: </span> Cory Gardner
                    </li>
                </ul>
            </nav>
            <h3 class="blurb-title">Cory Gardner <div class="tag-rep"></div>
            </h3>
            <img class="blurb-headshot" src="../images/cory-gardner-cropped.jpg">
            <p class="blurb-bio">Incumbent U.S. Senator, 45</p>
            <p class="blurb">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla scelerisque, felis a tempus iaculis, urna eros mattis ante, quis scelerisque urna nisl id eros. Curabitur vel orci elit. Vivamus vitae nisl mauris. Nunc gravida molestie lorem et fringilla. Vestibulum egestas ante ut ante pellentesque, in bibendum tellus eleifend. Ut non ex ex. Nullam id velit sodales, efficitur orci vitae, volutpat ante. Ut sollicitudin mi sit amet nisl lobortis interdum. Maecenas mi nisl, ullamcorper non odio non, pulvinar placerat orci. Suspendisse feugiat elit eget tortor iaculis aliquet. Praesent non urna et leo varius eleifend non convallis eros. <em><a href="https://www.denverpost.com/tag/cory-gardner/" target="_blank">Read Cory Gardner coverage &rarr;</a></em></p>
            <!-- <div class="callout secondary">
                <p><strong>Fundraising as of <span id="gardner-date"></span></strong><br>
                    <span class="blurb-fundraising">$<span id="gardner-cash"></span> cash on hand &bull; $<span id="gardner-raised"></span> raised during last quarter<br><a href="#fundraising-charts">View charts</a></span></p>
            </div> -->
            <!-- <hr> -->
        </div>
    </div>
    <div class="row" id="gardner-fundraising-charts">
        <div class="large-12 large-centered columns">
            <div class="callout secondary">
                <p class="chart-container-title">Fundraising Summary</p>
                <p>As of <span id="last-quarter-end-date"></span>, Cory Gardner had $<span id="candidate-cash"></span> on hand and raised $<span id="candidate-receipts-last-quarter"></span> in the last quarter. <em>Hover over or click chart for details.</em>
                    <div class="large-4 medium-4 columns">
                        <p class="chart-title">Quarterly contributions<br>and transfers</p>
                        <div id="donations-quarterly"></div>
                        <p class="source">Source: <a href="https://www.fec.gov/data/reports/house-senate/?is_amended=false&data_type=processed&committee_id=C00492454&cycle=2020" target="_blank">FEC quarterly report </a>
                    </div>
                    <div class="large-4 medium-4 columns">
                        <p class="chart-title">Total contributions<br>and transfers</p>
                        <div id="donations-breakdown"></div>
                        <p class="source">Source: <a href="https://www.fec.gov/data/committee/C00492454/?tab=raising&cycle=2020" target="_blank">FEC individual contributions</a>
                    </div>
                    <div class="large-4 medium-4 columns">
                        <p class="chart-title">Individual contributions<br>2019</p>
                        <div id="individual-donations-breakdown"></div>
                        <p class="source">Source: <a href="https://www.fec.gov/data/committee/C00492454/?tab=raising&cycle=2020" target="_blank">FEC individual contributions</a>
                    </div>
                    <p>&nbsp;</p>
            </div>
        </div>
    </div>
    <div id="contributions-table-container">
        <div class="row">
            <div class="large-12 columns">
                <h2 class="table-title">Search Cory Gardner's campaign contributions</h2>
                <p>Use the dropdown filters to isolate contributions by donor type (PAC, individual, etc.), name, employer or state, or search by a specific term. Click the column headers to sort the data. <strong>Source: Federal Election Commission</strong></em></p>
                <!-- <p style="color:#990012;font-style:italic;text-align:center">Click column headers to sort data; use dropdown menus to filter data</p> -->
            </div>
        </div>
        <div id="filters">
            <div class="row">
                <div class="large-3 medium-3 small-6 columns">
                    <span id="filter-1" style="font-weight: bold;"></span>
                </div>
                <div class="large-3 medium-3 small-6 columns">
                    <span id="filter-2" style="font-weight: bold;"></span>
                </div>
                <div class="large-3 medium-3 small-6 columns">
                    <span id="filter-3" style="font-weight: bold;"></span>
                </div>
                <div class="large-3 medium-3 small-6 end columns">
                    <span id="filter-4" style="font-weight: bold;"></span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="large-12 columns">
                <table id="contributions-table" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th></th>
                            <th>Candidate</th>
                            <th data-priority="1">Donor</th>
                            <th data-priority="4">Type</th>
                            <th>City</th>
                            <th>State</th>
                            <th>ZIP code</th>
                            <th>Employer</th>
                            <th>Occupation</th>
                            <th>Receipt type</th>
                            <th data-priority="2">Amount</th>
                            <th data-priority="3">YTD total</th>
                            <th>Year</th>
                            <th>Quarter</th>
                            <th>Election type</th>
                            <th>PDF link</th>
                        </tr>
                    </thead>
                    <tfoot>
                    </tfoot>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
    //$.getJSON('../data/gardner_test.json', function(data) {
    $.getJSON('fec_test_data.json', function(data) {

        // Period bar chart data
        var quarterlyBarChartData = data.map(d => {
            return {
                "report_time": d.report_type + ' ' + d.report_year,
                "total_individual_contributions_period": d.total_individual_contributions_period,
                "political_party_committee_contributions_period": d.political_party_committee_contributions_period,
                "other_political_committee_contributions_period": d.other_political_committee_contributions_period,
                "transfers_from_other_authorized_committee_period": d.transfers_from_other_authorized_committee_period
            }
        });

        // Get last object (should be most recent filing period) in array
        var lastQuarterData = data.slice(-1).pop();

        // Cash on hand at end of period
        var cashOnHand = lastQuarterData.cash_on_hand_end_period;
        document.getElementById('candidate-cash').innerHTML = Math.round(cashOnHand).toLocaleString();

        // Total receipts for latest quarter
        var lastQuarterReceipts = lastQuarterData.total_receipts_period;
        document.getElementById('candidate-receipts-last-quarter').innerHTML = Math.round(lastQuarterReceipts).toLocaleString();

        // Last quarter end date
        var lastQuarterEndDate = moment(lastQuarterData.coverage_end_date, 'YYYY-MM-DD h:mm:ss').format('MMM DD, YYYY');
        document.getElementById('last-quarter-end-date').innerHTML = lastQuarterEndDate;

        // YTD pie chart data
        const ytdPieChartDataObject = (({ total_individual_contributions_ytd, political_party_committee_contributions_ytd, other_political_committee_contributions_ytd, transfers_from_other_authorized_committee_ytd }) => ({ total_individual_contributions_ytd, political_party_committee_contributions_ytd, other_political_committee_contributions_ytd, transfers_from_other_authorized_committee_ytd }))(lastQuarterData);
        var ytdPieChartData = [];
        ytdPieChartData.push(ytdPieChartDataObject);
        console.log(ytdPieChartDataObject);

        /*** BAR CHART ***/
        var donationsQuarterly = c3.generate({
            bindto: '#donations-quarterly',
            data: {
                json: quarterlyBarChartData,
                keys: {
                    x: 'report_time',
                    value: ['total_individual_contributions_period', 'political_party_committee_contributions_period', 'other_political_committee_contributions_period', 'transfers_from_other_authorized_committee_period'],
                },
                names: {
                    total_individual_contributions_period: 'Individuals',
                    political_party_committee_contributions_period: 'Political party committees',
                    other_political_committee_contributions_period: 'Other political committees (PACs)',
                    transfers_from_other_authorized_committee_period: 'Transfers from other authorized committees'
                },
                type: 'bar',
                groups: [
                    ['total_individual_contributions_period', 'political_party_committee_contributions_period', 'other_political_committee_contributions_period', 'transfers_from_other_authorized_committee_period']
                ],
                order: 'desc',
                colors: {
                    'total_individual_contributions_period': '#5e3c99',
                    'transfers_from_other_authorized_committee_period': '#807dba',
                    'other_political_committee_contributions_period': '#e66101',
                    'political_party_committee_contributions_period': '#fdb863'
                }
            },
            padding: {
                bottom: 40
            },
            axis: {
                x: {
                    type: 'category',
                },
                y: {
                    tick: {
                        //values: [3000000, 5000000, 7000000, 9000000],
                        format: function(d) {
                            return d3.format('$.1s')(d)
                        }
                    },
                }
            },
            tooltip: {
                format: {
                    value: function(value, ratio, id) {
                        return d3.format('$,')(value)
                    }
                }
            },
            grid: {
                x: {
                    show: true
                },
                y: {
                    show: true
                }
            }
        });

        /*** PIE CHART - TOTAL RUNDRAISING BREAKDOWN***/
        var donationsBreakdown = c3.generate({
            bindto: '#donations-breakdown',
            data: {
                //     columns: [
                //         ['$2,000 and over', individualBreakdown[4]],
                //         ['$1,000-$1,999', individualBreakdown[3]],
                //         ['$500-$999', individualBreakdown[2]],
                //         ['$201-$499', individualBreakdown[1]],
                //         ['$200 and under', individualBreakdown[0]]
                //     ],
                json: ytdPieChartData,
                keys: {
                    //x: 'date',
                    // x: ['total_individual_contributions_ytd', 'political_party_committee_contributions_ytd', 'other_political_committee_contributions_ytd',
                    //     'transfers_from_other_authorized_committee_ytd'
                    // ],
                    value: ['total_individual_contributions_ytd', 'political_party_committee_contributions_ytd', 'other_political_committee_contributions_ytd',
                        'transfers_from_other_authorized_committee_ytd'
                    ]
                },
                names: {
                    total_individual_contributions_ytd: 'Individuals',
                    political_party_committee_contributions_ytd: 'Political party committees',
                    other_political_committee_contributions_ytd: 'Other political committees (PACs)',
                    transfers_from_other_authorized_committee_ytd: 'Transfers from other authorized committees'
                },
                type: 'pie',
                colors: {
                    'total_individual_contributions_ytd': '#5e3c99',
                    'transfers_from_other_authorized_committee_ytd': '#807dba',
                    'other_political_committee_contributions_ytd': '#e66101',
                    'political_party_committee_contributions_ytd': '#fdb863'
                },
                onclick: function(d, i) { console.log("onclick", d, i); },
                onmouseover: function(d, i) { console.log("onmouseover", d, i); },
                onmouseout: function(d, i) { console.log("onmouseout", d, i); }
            },
            tooltip: {
                format: {
                    value: function(value, ratio, id) {
                        return d3.format('$,')(value)
                    }
                }
            }
        })
    });

    /*** PIE CHART - INDIVIDUAL DONATION BREAKDOWN ***/
    var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1neSnWnUNBpRHf7hCISm1v4mM2CDIOclsEJeez0R7kcQ/edit#gid=0';

    function init() {
        Tabletop.init({
            key: publicSpreadsheetUrl,
            callback: function(data, tabletop) {
                console.log(data);
                var individualDonationsBreakdown = c3.generate({
                    bindto: '#individual-donations-breakdown',
                    data: {
                        // columns: [
                        //     ['$2,000 and over', individualBreakdown[4]],
                        //     ['$1,000-$1,999', individualBreakdown[3]],
                        //     ['$500-$999', individualBreakdown[2]],
                        //     ['$201-$499', individualBreakdown[1]],
                        //     ['$200 and under', individualBreakdown[0]]
                        // ],
                        json: data,
                        keys: {
                            //x: 'category',
                            //x: [ '$200 and under', '$201-$499', '$500-$999', '$1,000-$1,999', '$2,000 and over' ],
                            value: ['gardner_amount']
                        },
                        type: 'pie',
                        colors: {
                            '$2,000 and over': '#4a1486',
                            '$1,000-$1,999': '#6a51a3',
                            '$500-$999': '#807dba',
                            '$201-$499': '#9e9ac8',
                            '$200 and under': '#bcbddc'
                        },
                        onclick: function(d, i) { console.log("onclick", d, i); },
                        onmouseover: function(d, i) { console.log("onmouseover", d, i); },
                        onmouseout: function(d, i) { console.log("onmouseout", d, i); }
                    },
                    tooltip: {
                        format: {
                            value: function(value, ratio, id) {
                                return d3.format('$,')(value)
                            }
                        }
                    },
                    padding: {
                        bottom: 40
                    },
                })
            },
            simpleSheet: true,
            parseNumbers: true
        });
    }
    window.addEventListener('DOMContentLoaded', init)
    </script>
</body>

</html>