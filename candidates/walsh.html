<!DOCTYPE html>
<html lang="en">

<head>
    <title>John Walsh: 2020 Senate Race | The Denver Post</title>
    <meta charset="utf-8">
    <meta name="robots" content="noindex,follow">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Condensed:700|Roboto+Mono" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/dataTables.foundation.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/foundation/6.2.4/foundation.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.1/css/responsive.foundation.min.css" />
    <!-- <link rel="stylesheet" href="jquery.dataTables.yadcf.css" /> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.14/c3.css" />
    <link rel="stylesheet" href="../css/styles.css" />
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.16/js/dataTables.foundation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/foundation/6.2.4/foundation.min.js"></script>
    <script src="https://cdn.datatables.net/plug-ins/1.10.16/dataRender/datetime.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.1/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.1/js/responsive.foundation.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/yadcf/0.9.2/jquery.dataTables.yadcf.js"></script>
    <script src="https://extras.denverpost.com/app/homicide-report/js/d3.v3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.14/c3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
    <script src="../js/moment.js"></script>
</head>

<body>
    <div class="row">
        <div class="large-8 large-centered medium-10 medium-centered columns">
            <h1 class="title">Colorado<br>U.S. Senate Race</h1>
            <hr>
            <h2 class="title"><span id="title-year">2020</span></h2>
        </div>
    </div>
    <div class="row page-top">
        <div class="large-11 large-centered columns">
            <hr>
            <nav aria-label="You are here:" role="navigation">
                <ul class="breadcrumbs">
                    <li><a href="../index.html">Home</a></li>
                    <li>
                        <span class="show-for-sr">Current: </span> John Walsh
                    </li>
                </ul>
            </nav>
            <h3 class="blurb-title">John Walsh <div class="tag-dem"></div>
            </h3>
            <img class="blurb-headshot" src="../images/john-walsh-cropped.jpg">
            <p class="blurb-bio">Former U.S. attorney, 57</p>
            <p class="blurb"><span class="withdrew-text"><a href="https://www.denverpost.com/2019/09/11/john-walsh-colorado-senate-hickenlooper/" target="_blank">Withdrew Sept. 11</a></span> &bull; Walsh, 57, was rumored to be entering the race for weeks before his April 16 announcement. For six years during the Obama administration, he was the top federal prosecutor in Colorado. He gained the immediate endorsement of former U.S. Attorney General Eric Holder, among others. “This state has been so good to me and my family,” he said in a video announcement. “I spent my whole life fighting against institutions and individuals who have tried to get in the way of an open and fair system for all.” &bull; <em><a href="https://www.denverpost.com/tag/john-walsh/" target="_blank">Read John Walsh coverage &rarr;</a></em></p>
        </div>
    </div>
    <div class="row" id="fundraising-charts">
        <div class="large-11 large-centered columns">
            <div class="callout secondary">
                <p class="chart-container-title">Fundraising as of <span id="last-quarter-end-date"></span></p>
                <p>Walsh began the quarter with <span class="highlight">$<span id="candidate-cash-beginning"></span></span> cash on hand and ended it with <span class="highlight">$<span id="candidate-cash"></span></span> cash on hand. He raised <span class="highlight">$<span id="candidate-receipts-last-quarter"></span></span> during the quarter and has raised <span class="highlight">$<span id="candidate-receipts-ytd"></span></span> in the election cycle*.</p>
                <p class="table-instructions">Hover over or click chart for details</p>
                <div class="large-4 medium-4 columns">
                    <p class="chart-title">Quarterly<br>contributions</p>
                    <div id="donations-quarterly"></div>
                    <p class="source">Source: <a href="https://www.fec.gov/data/reports/house-senate/?is_amended=false&data_type=processed&committee_id=C00702381&cycle=2020" target="_blank">FEC quarterly report </a>
                </div>
                <div class="large-4 medium-4 columns">
                    <p class="chart-title">Total<br>contributions</p>
                    <div id="donations-breakdown"></div>
                    <p class="source">Source: <a href="https://www.fec.gov/data/committee/C00702381/?tab=raising&cycle=2020#total-receipts" target="_blank">FEC total receipts</a>
                </div>
                <div class="large-4 medium-4 columns">
                    <p class="chart-title">Individual<br>contributions</p>
                    <div id="individual-donations-breakdown"></div>
                    <p class="source">Source: <a href="https://www.fec.gov/data/committee/C00702381/?tab=raising&cycle=2020" target="_blank">FEC individual contributions</a>
                </div>
                <p class="note">*Quarterly and total data may differ due to delayed reporting of some information, such as contribution refunds</p>
                <p>&nbsp;</p>
            </div>
        </div>
    </div>
    <div id="contributions-table-container">
        <div class="row">
            <div class="large-11 large-centered columns" style="border-top:5px solid #252525;">
                <h2 class="table-title">Search John Walsh&rsquo;s campaign contributions</h2>
                <p>Use the dropdown filters to isolate contributions by donor type (PAC, individual, etc.), name, state or employer, or search by a specific term. <em>Source: <a href="https://www.fec.gov/data/receipts/?two_year_transaction_period=2020&committee_id=C00492454&data_type=processed" target="_blank">FEC 2019-20 receipts</a></em></p>
                <p class="table-instructions">Click column headers to sort &bull; scroll right to see full table</p>
            </div>
        </div>
        <div id="filters">
            <div class="row">
                <div class="large-11 large-centered columns">
                    <div class="row">
                        <div class="large-3 medium-3 small-6 columns">
                            <p id="filter-1"></p>
                        </div>
                        <div class="large-3 medium-3 small-6 columns">
                            <p id="filter-2"></p>
                        </div>
                        <div class="large-3 medium-3 small-6 columns end">
                            <p id="filter-3"></p>
                        </div>
                        <div class="large-3 medium-3 small-6 columns end">
                            <p id="filter-4"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="large-11 large-centered columns">
                <table id="contributions-table" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>Candidate</th>
                            <th data-priority="4">Donor type</th>
                            <th data-priority="1">Name</th>
                            <th data-priority="2">Amount</th>
                            <th data-priority="3">YTD total</th>
                            <th>City</th>
                            <th>State</th>
                            <th>ZIP</th>
                            <th>Employer</th>
                            <th>Occupation</th>
                            <th>Quarter</th>
                            <th>Year</th>
                            <th>Receipt type</th>
                            <th>Election type</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
    $.getJSON('../data/walsh/walsh_current_charts.json', function(data) {

        // Period bar chart data
        var quarterlyBarChartData = data.map(d => {
            return {
                "report_time": d.report_type + ' ' + d.report_year,
                "total_individual_contributions_period": d.total_individual_contributions_period,
                "political_party_committee_contributions_period": d.political_party_committee_contributions_period,
                "other_political_committee_contributions_period": d.other_political_committee_contributions_period,
                "transfers_from_other_authorized_committee_period": d.transfers_from_other_authorized_committee_period,
                "candidate_contribution_period": d.candidate_contribution_period
            }
        });

        // Get last object (should be most recent filing period) in array
        var lastQuarterData = data.slice(-1).pop();

        // Cash on hand at beginning of period
        var beginningCashOnHand = lastQuarterData.cash_on_hand_beginning_period;
        document.getElementById('candidate-cash-beginning').innerHTML = Math.round(beginningCashOnHand).toLocaleString();

        // Cash on hand at end of period
        var cashOnHand = lastQuarterData.cash_on_hand_end_period;
        document.getElementById('candidate-cash').innerHTML = Math.round(cashOnHand).toLocaleString();

        // Total receipts for latest quarter
        var lastQuarterReceipts = lastQuarterData.total_receipts_period;
        document.getElementById('candidate-receipts-last-quarter').innerHTML = Math.round(lastQuarterReceipts).toLocaleString();

        // Total receipts YTD
        var ytdReceipts = lastQuarterData.total_receipts_ytd;
        document.getElementById('candidate-receipts-ytd').innerHTML = Math.round(ytdReceipts).toLocaleString();

        // Last quarter end date
        var lastQuarterEndDate = moment(lastQuarterData.coverage_end_date, 'YYYY-MM-DD h:mm:ss').format('MMM DD, YYYY');
        document.getElementById('last-quarter-end-date').innerHTML = lastQuarterEndDate;

        // YTD pie chart data
        const ytdPieChartDataObject = (({ total_individual_contributions_ytd, political_party_committee_contributions_ytd, other_political_committee_contributions_ytd, transfers_from_other_authorized_committee_ytd, candidate_contribution_ytd }) => ({ total_individual_contributions_ytd, political_party_committee_contributions_ytd, other_political_committee_contributions_ytd, transfers_from_other_authorized_committee_ytd, candidate_contribution_ytd }))(lastQuarterData);
        var ytdPieChartData = [];
        ytdPieChartData.push(ytdPieChartDataObject);

        /*** BAR CHART - QUARTERLY CONTRIBUTIONS***/
        var donationsQuarterly = c3.generate({
            bindto: '#donations-quarterly',
            data: {
                json: quarterlyBarChartData,
                keys: {
                    x: 'report_time',
                    value: ['total_individual_contributions_period',
                        'candidate_contribution_period',
                        'other_political_committee_contributions_period',
                        'transfers_from_other_authorized_committee_period',
                        'political_party_committee_contributions_period'
                    ],
                },
                names: {
                    total_individual_contributions_period: 'Individuals',
                    candidate_contribution_period: 'Candidate contributions',
                    other_political_committee_contributions_period: 'Other political committees (PACs)',
                    political_party_committee_contributions_period: 'Political party committees',
                    transfers_from_other_authorized_committee_period: 'Transfers from other committees'
                },
                type: 'bar',
                groups: [
                    ['total_individual_contributions_period',
                        'candidate_contribution_period',
                        'political_party_committee_contributions_period',
                        'other_political_committee_contributions_period',
                        'transfers_from_other_authorized_committee_period'
                    ]
                ],
                order: null,
                colors: {
                    'total_individual_contributions_period': '#5e3c99',
                    'transfers_from_other_authorized_committee_period': '#807dba',
                    'other_political_committee_contributions_period': '#e66101',
                    'political_party_committee_contributions_period': '#fdb863',
                    'candidate_contribution_period': '#bbb'
                }
            },
            // padding: {
            //     bottom: 20
            // },
            axis: {
                x: {
                    type: 'category',
                },
                y: {
                    tick: {
                        format: function(d) {
                            return d3.format('$.2s')(d)
                        }
                    },
                }
            },
            tooltip: {
                format: {
                    value: function(value, ratio, id) {
                        return d3.format('$,')(value)
                    }
                }
            },
            grid: {
                x: {
                    show: true
                },
                y: {
                    show: true
                }
            }
        });

        /*** PIE CHART - TOTAL FUNDRAISING BREAKDOWN ***/
        var donationsBreakdown = c3.generate({
            bindto: '#donations-breakdown',
            data: {
                json: ytdPieChartData,
                keys: {
                    value: ['total_individual_contributions_ytd',
                    //'political_party_committee_contributions_ytd',
                    'other_political_committee_contributions_ytd',
                    //'transfers_from_other_authorized_committee_ytd',
                    'candidate_contribution_ytd'
                    ]
                },
                names: {
                    total_individual_contributions_ytd: 'Individuals',
                    //political_party_committee_contributions_ytd: 'Political party committees',
                    other_political_committee_contributions_ytd: 'Other political committees (PACs)',
                    //transfers_from_other_authorized_committee_ytd: 'Transfers from other authorized committees',
                    candidate_contribution_ytd: 'Candidate contributions'
                },
                type: 'pie',
                colors: {
                    'total_individual_contributions_ytd': '#5e3c99',
                    'transfers_from_other_authorized_committee_ytd': '#807dba',
                    'other_political_committee_contributions_ytd': '#e66101',
                    'political_party_committee_contributions_ytd': '#fdb863',
                    'candidate_contribution_ytd': '#bbb'
                },
                onclick: function(d, i) { console.log("onclick", d, i); },
                onmouseover: function(d, i) { console.log("onmouseover", d, i); },
                onmouseout: function(d, i) { console.log("onmouseout", d, i); }
            },
            tooltip: {
                format: {
                    value: function(value, ratio, id) {
                        return d3.format('$,')(value)
                    }
                }
            }
        })
    });

    /*** PIE CHART - INDIVIDUAL DONATION BREAKDOWN ***/
    var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1neSnWnUNBpRHf7hCISm1v4mM2CDIOclsEJeez0R7kcQ/edit#gid=0';

    function init() {
        Tabletop.init({
            key: publicSpreadsheetUrl,
            callback: function(data, tabletop) {
                var individualDonationsBreakdown = c3.generate({
                    bindto: '#individual-donations-breakdown',
                    data: {
                        json: data,
                        keys: {
                            value: ['walsh_under_200', 'walsh_under_500', 'walsh_under_1000', 'walsh_under_2000', 'walsh_over_2000']
                        },
                        names: {
                            walsh_under_200: 'Less than $200',
                            walsh_under_500: '$201-$500',
                            walsh_under_1000: '$501-$1,000',
                            walsh_under_2000: '$1,001-$2,000',
                            walsh_over_2000: 'More than $2,000'
                        },
                        type: 'pie',
                        colors: {
                            'walsh_over_2000': '#4a1486',
                            'walsh_under_2000': '#6a51a3',
                            'walsh_under_1000': '#807dba',
                            'walsh_under_500': '#9e9ac8',
                            'walsh_under_200': '#bcbddc'
                        },
                        onclick: function(d, i) { console.log("onclick", d, i); },
                        onmouseover: function(d, i) { console.log("onmouseover", d, i); },
                        onmouseout: function(d, i) { console.log("onmouseout", d, i); }
                    },
                    tooltip: {
                        format: {
                            value: function(value, ratio, id) {
                                return d3.format('$,')(value)
                            }
                        }
                    },
                    // padding: {
                    //     bottom: 15
                    // },
                })
            },
            simpleSheet: true,
            parseNumbers: true
        });
    }

    /*** TABLE ***/
    var dataFile = '../data/walsh/walsh_current_table.json';

    $(document).ready(function() {
        function disableDependentFilter(level, inuse) {
            if (level < 4) {
                filter = $('#yadcf-filter--example-' + level);
                yadcf.exResetFilters(contributionsTable, [level]);
                filter.prop('disabled', !inuse);

                disableDependentFilter(level + 1, false);
            }
        }

        var contributionsTable = $('#contributions-table').DataTable({
            ajax: {
                'url': dataFile,
                'dataSrc': ''
            },
            // pageLength: 15,
            scrollY: '1000px',
            //scrollCollapse: true,
            scrollX: true,
            paging: true,
            pageLength: 50,
            fixedHeader: true,
            // responsive: {
            //     details: {
            //         type: 'column'
            //     }
            // },
            dom: '<if<t>lp>',
            order: [
                [4, 'desc'],
                [3, 'desc']
            ],
            columns: [
                //{ data: 'button' },
                {
                    data: 'committee_name',
                    visible: false
                }, {
                    data: 'entity_type_desc',
                    visible: true
                },
                {
                    data: 'contributor_name',
                },
                {
                    data: 'contribution_receipt_amount',
                    render: function(data, type, row) {
                        return '$' + Math.round(data).toLocaleString()
                    }
                },
                {
                    data: 'contributor_aggregate_ytd',
                    render: function(data, type, row) {
                        return '$' + Math.round(data).toLocaleString()
                    }
                },
                {
                    data: 'contributor_city',
                    visible: true
                },
                {
                    data: 'contributor_state',
                    visible: true
                },
                {
                    data: 'contributor_zip',
                    visible: false,
                    render: function(data, type, row) {
                        if (data != null) {
                            return data.toString().slice(0, 5)
                        }
                    }
                },
                { data: 'contributor_employer' },
                {
                    data: 'contributor_occupation',
                },
                {
                    data: 'report_type',
                    visible: true
                },
                {
                    data: 'report_year',
                    visible: true
                },
                {
                    data: 'receipt_type_full',
                    visible: true
                },
                { data: 'fec_election_type_desc' }
            ],

            initComplete: function() {
                yadcf.init(contributionsTable, [{
                        column_number: 1,
                        filter_container_id: 'filter-1',
                        filter_default_label: 'Filter by donor type',
                        //data: donorTypes
                    },
                    {
                        column_number: 2,
                        filter_container_id: 'filter-2',
                        filter_default_label: 'Filter by name'
                    },
                    {
                        column_number: 6,
                        filter_container_id: 'filter-3',
                        filter_default_label: 'Filter by state'
                    },
                    {
                        column_number: 8,
                        filter_container_id: 'filter-4',
                        filter_default_label: 'Filter by employer'
                    },
                ], {
                    cumulative_filtering: true,
                    filter_reset_button_text: 'Reset filter'
                });

                disableDependentFilter(1, true);

                $('.yadcf-filter-reset-button').on('click', function() {
                    level = parseInt(this.id.split('-')[1]);
                    disableDependentFilter(level, true);
                });

                $('.yadcf-filter').on('change', function() {
                    level = parseInt(this.id.slice(-1));
                    inuse = $(this).hasClass('inuse');

                    disableDependentFilter(level + 1, inuse);
                });
            }
        });
    });
    window.addEventListener('DOMContentLoaded', init)
    </script>
</body>

</html>